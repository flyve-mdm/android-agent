<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>PoliciesData.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=0;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">debugAndroidTest</a> &gt; <a href="index.source.html" class="el_package">org.flyve.mdm.agent.data</a> &gt; <span class="el_source">PoliciesData.java</span></div><h1>PoliciesData.java</h1><pre class="source lang-java linenums">package org.flyve.mdm.agent.data;

/*
 *   Copyright © 2018 Teclib. All rights reserved.
 *
 *   This file is part of flyve-mdm-android
 *
 * flyve-mdm-android is a subproject of Flyve MDM. Flyve MDM is a mobile
 * device management software.
 *
 * Flyve MDM is free software: you can redistribute it and/or
 * modify it under the terms of the GNU General Public License
 * as published by the Free Software Foundation; either version 3
 * of the License, or (at your option) any later version.
 *
 * Flyve MDM is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 * ------------------------------------------------------------------------------
 * @author    Rafael Hernandez
 * @date      8/4/18
 * @copyright Copyright © 2018 Teclib. All rights reserved.
 * @license   GPLv3 https://www.gnu.org/licenses/gpl-3.0.html
 * @link      https://github.com/flyve-mdm/flyve-mdm-android
 * @link      https://flyve-mdm.com
 * ------------------------------------------------------------------------------
 */

import android.content.Context;

import org.flyve.mdm.agent.room.database.AppDataBase;
import org.flyve.mdm.agent.room.entity.Policies;

import java.util.List;

public class PoliciesData {

    private static final String PASSWORD_ENABLED = &quot;passwordEnabled&quot;;
    private static final String PASSWORD_QUALITY = &quot;passwordQuality&quot;;
    private static final String PASSWORD_MINIMUM_LENGTH = &quot;passwordMinimumLength&quot;;
    private static final String PASSWORD_MINIMUM_LOWER_CASE = &quot;passwordMinimumLowerCase&quot;;
    private static final String PASSWORD_MINIMUM_UPPER_CASE = &quot;passwordMinimumUpperCase&quot;;
    private static final String PASSWORD_MINIMUM_NON_LETTER = &quot;passwordMinimumNonLetter&quot;;
    private static final String PASSWORD_MINIMUM_LETTERS = &quot;passwordMinimumLetters&quot;;
    private static final String PASSWORD_MINIMUM_NUMERIC = &quot;passwordMinimumNumeric&quot;;
    private static final String PASSWORD_MINIMUM_SYMBOLS = &quot;passwordMinimumSymbols&quot;;
    private static final String MAXIMUM_FAILED_PASSWORDS_FOR_WIPE = &quot;maximumFailedPasswordsForWipe&quot;;
    private static final String MAXIMUM_TIME_TO_LOCK = &quot;maximumTimeToLock&quot;;
    private static final String STORAGE_ENCRYPTION = &quot;storageEncryption&quot;;
    private static final String DISABLE_CAMERA = &quot;disableCamera&quot;;
    private static final String DISABLE_BLUETOOTH = &quot;disableBluetooth&quot;;
    private static final String DISABLE_SCREEN_CAPTURE = &quot;disableScreenCapture&quot;;
    private static final String DISABLE_AIRPLANE_MODE = &quot;disableAirplaneMode&quot;;
    private static final String DISABLE_GPS = &quot;disableGPS&quot;;
    private static final String DISABLE_HOSTPOT_TETHERING = &quot;disableHostpotTethering&quot;;
    private static final String DISABLE_ROAMING = &quot;disableRoaming&quot;;
    private static final String DISABLE_WIFI = &quot;disableWifi&quot;;
    private static final String USE_TLS = &quot;useTLS&quot;;
    private static final String DISABLE_MOBILE_LINE = &quot;disableMobileLine&quot;;
    private static final String DISABLE_NFC = &quot;disableNFC&quot;;
    private static final String DISABLE_STATUSBAR = &quot;disableStatusbar&quot;;
    private static final String DISABLE_USB_MTP = &quot;disableUsbMtp&quot;;
    private static final String DISABLE_USB_PTP = &quot;disableUsbPtp&quot;;
    private static final String DISABLE_USB_ADB = &quot;disableUsbAdb&quot;;
    private static final String DISABLE_SPEAKER_PHONE = &quot;disableSpeakerphone&quot;;
    private static final String DISABLE_VPN = &quot;disableVPN&quot;;
    private static final String DISABLE_SMS_MMS = &quot;disableSmsMms&quot;;

    private AppDataBase dataBase;

<span class="nc" id="L72">    public PoliciesData(Context context) {</span>
<span class="nc" id="L73">        dataBase = AppDataBase.getAppDatabase(context);</span>
<span class="nc" id="L74">    }</span>

    public boolean getPasswordEnabled() {
<span class="nc" id="L77">        return getBooleanValue(PASSWORD_ENABLED);</span>
    }

    public Object setPasswordEnabled(Boolean enable, int priority) {
<span class="nc" id="L81">        return setBooleanValue(PASSWORD_ENABLED, enable, priority);</span>
    }

    public String getPasswordQuality() {
<span class="nc" id="L85">        return getStringValue(PASSWORD_QUALITY);</span>
    }

    public Object setPasswordQuality(String value, int priority) {
<span class="nc" id="L89">        return setStringValue(PASSWORD_QUALITY, value, priority);</span>
    }

    public int getPasswordMinimumLength() {
<span class="nc" id="L93">        return getIntValue(PASSWORD_MINIMUM_LENGTH);</span>
    }

    public Object setPasswordMinimumLength(int value, int priority) {
<span class="nc" id="L97">        return setIntValue(PASSWORD_MINIMUM_LENGTH, value, priority);</span>
    }

    public int getPasswordMinimumLowerCase() {
<span class="nc" id="L101">        return getIntValue(PASSWORD_MINIMUM_LOWER_CASE);</span>
    }

    public Object setPasswordMinimumLowerCase(int value, int priority) {
<span class="nc" id="L105">        return setIntValue(PASSWORD_MINIMUM_LOWER_CASE, value, priority);</span>
    }

    public int getPasswordMinimumUpperCase() {
<span class="nc" id="L109">        return getIntValue(PASSWORD_MINIMUM_UPPER_CASE);</span>
    }

    public Object setPasswordMinimumUpperCase(int value, int priority) {
<span class="nc" id="L113">        return setIntValue(PASSWORD_MINIMUM_UPPER_CASE, value, priority);</span>
    }

    public int getPasswordMinimumNonLetter() {
<span class="nc" id="L117">        return getIntValue(PASSWORD_MINIMUM_NON_LETTER);</span>
    }

    public Object setPasswordMinimumNonLetter(int value, int priority) {
<span class="nc" id="L121">        return setIntValue(PASSWORD_MINIMUM_NON_LETTER, value, priority);</span>
    }

    public int getPasswordMinimumLetters() {
<span class="nc" id="L125">        return getIntValue(PASSWORD_MINIMUM_LETTERS);</span>
    }

    public Object setPasswordMinimumLetters(int value, int priority) {
<span class="nc" id="L129">        return setIntValue(PASSWORD_MINIMUM_LETTERS, value, priority);</span>
    }

    public int getPasswordMinimumNumeric() {
<span class="nc" id="L133">        return getIntValue(PASSWORD_MINIMUM_NUMERIC);</span>
    }

    public Object setPasswordMinimumNumeric(int value, int priority) {
<span class="nc" id="L137">        return setIntValue(PASSWORD_MINIMUM_NUMERIC, value, priority);</span>
    }

    public int getPasswordMinimumSymbols() {
<span class="nc" id="L141">        return getIntValue(PASSWORD_MINIMUM_SYMBOLS);</span>
    }

    public Object setPasswordMinimumSymbols(int value, int priority) {
<span class="nc" id="L145">        return setIntValue(PASSWORD_MINIMUM_SYMBOLS, value, priority);</span>
    }

    public int getMaximumFailedPasswordsForWipe() {
<span class="nc" id="L149">        return getIntValue(MAXIMUM_FAILED_PASSWORDS_FOR_WIPE);</span>
    }

    public Object setMaximumFailedPasswordsForWipe(int value, int priority) {
<span class="nc" id="L153">        return setIntValue(MAXIMUM_FAILED_PASSWORDS_FOR_WIPE, value, priority);</span>
    }

    public int getMaximumTimeToLock() {
<span class="nc" id="L157">        return getIntValue(MAXIMUM_TIME_TO_LOCK);</span>
    }

    public Object setMaximumTimeToLock(int value, int priority) {
<span class="nc" id="L161">        return setIntValue(MAXIMUM_TIME_TO_LOCK, value, priority);</span>
    }

    public boolean getStorageEncryption() {
<span class="nc" id="L165">        return getBooleanValue(STORAGE_ENCRYPTION);</span>
    }

    public Object setStorageEncryption(boolean value, int priority) {
<span class="nc" id="L169">        return setBooleanValue(STORAGE_ENCRYPTION, value, priority);</span>
    }

    public boolean getDisableCamera() {
<span class="nc" id="L173">        return getBooleanValue(DISABLE_CAMERA);</span>
    }

    public Object setDisableCamera(boolean value, int priority) {
<span class="nc" id="L177">        return setBooleanValue(DISABLE_CAMERA, value, priority);</span>
    }

    public boolean getDisableBluetooth() {
<span class="nc" id="L181">        return getBooleanValue(DISABLE_BLUETOOTH);</span>
    }

    public Object setDisableBluetooth(boolean value, int priority) {
<span class="nc" id="L185">        return setBooleanValue(DISABLE_BLUETOOTH, value, priority);</span>
    }

    public boolean getDisableScreenCapture() {
<span class="nc" id="L189">        return getBooleanValue(DISABLE_SCREEN_CAPTURE);</span>
    }

    public Object setDisableScreenCapture(boolean value, int priority) {
<span class="nc" id="L193">        return setBooleanValue(DISABLE_SCREEN_CAPTURE, value, priority);</span>
    }

    public boolean getDisableAirplaneMode() {
<span class="nc" id="L197">        return getBooleanValue(DISABLE_AIRPLANE_MODE);</span>
    }

    public Object setDisableAirplaneMode(boolean value, int priority) {
<span class="nc" id="L201">        return setBooleanValue(DISABLE_AIRPLANE_MODE, value, priority);</span>
    }

    public boolean getDisableGPS() {
<span class="nc" id="L205">        return getBooleanValue(DISABLE_GPS);</span>
    }

    public Object setDisableGPS(boolean value, int priority) {
<span class="nc" id="L209">        return setBooleanValue(DISABLE_GPS, value, priority);</span>
    }

    public boolean getDisableHostpotTethering() {
<span class="nc" id="L213">        return getBooleanValue(DISABLE_HOSTPOT_TETHERING);</span>
    }

    public Object setDisableHostpotTethering(boolean value, int priority) {
<span class="nc" id="L217">        return setBooleanValue(DISABLE_HOSTPOT_TETHERING, value, priority);</span>
    }

    public boolean getDisableRoaming() {
<span class="nc" id="L221">        return getBooleanValue(DISABLE_ROAMING);</span>
    }

    public Object setDisableRoaming(boolean value, int priority) {
<span class="nc" id="L225">        return setBooleanValue(DISABLE_ROAMING, value, priority);</span>
    }

    public boolean getDisableWifi() {
<span class="nc" id="L229">        return getBooleanValue(DISABLE_WIFI);</span>
    }

    public Object setDisableWifi(boolean value, int priority) {
<span class="nc" id="L233">        return setBooleanValue(DISABLE_WIFI, value, priority);</span>
    }

    public boolean getUseTLS() {
<span class="nc" id="L237">        return getBooleanValue(USE_TLS);</span>
    }

    public Object setUseTLS(boolean value, int priority) {
<span class="nc" id="L241">        return setBooleanValue(USE_TLS, value, priority);</span>
    }

    public boolean getDisableMobileLine() {
<span class="nc" id="L245">        return getBooleanValue(DISABLE_MOBILE_LINE);</span>
    }

    public Object setDisableMobileLine(boolean value, int priority) {
<span class="nc" id="L249">        return setBooleanValue(DISABLE_MOBILE_LINE, value, priority);</span>
    }

    public boolean getDisableNFC() {
<span class="nc" id="L253">        return getBooleanValue(DISABLE_NFC);</span>
    }

    public Object setDisableNFC(boolean value, int priority) {
<span class="nc" id="L257">        return setBooleanValue(DISABLE_NFC, value, priority);</span>
    }

    public boolean getDisableStatusbar() {
<span class="nc" id="L261">        return getBooleanValue(DISABLE_STATUSBAR);</span>
    }

    public Object setDisableStatusbar(boolean value, int priority) {
<span class="nc" id="L265">        return setBooleanValue(DISABLE_STATUSBAR, value, priority);</span>
    }

    public boolean getDisableUsbMtp() {
<span class="nc" id="L269">        return getBooleanValue(DISABLE_USB_MTP);</span>
    }

    public Object setDisableUsbMtp(boolean value, int priority) {
<span class="nc" id="L273">        return setBooleanValue(DISABLE_USB_MTP, value, priority);</span>
    }

    public boolean getDisableUsbPtp() {
<span class="nc" id="L277">        return getBooleanValue(DISABLE_USB_PTP);</span>
    }

    public Object setDisableUsbPtp(boolean value, int priority) {
<span class="nc" id="L281">        return setBooleanValue(DISABLE_USB_PTP, value, priority);</span>
    }

    public boolean getDisableUsbAdb() {
<span class="nc" id="L285">        return getBooleanValue(DISABLE_USB_ADB);</span>
    }

    public Object setDisableUsbAdb(boolean value, int priority) {
<span class="nc" id="L289">        return setBooleanValue(DISABLE_USB_ADB, value, priority);</span>
    }

    public boolean getDisableSpeakerphone() {
<span class="nc" id="L293">        return getBooleanValue(DISABLE_SPEAKER_PHONE);</span>
    }

    public Object setDisableSpeakerphone(boolean value, int priority) {
<span class="nc" id="L297">        return setBooleanValue(DISABLE_SPEAKER_PHONE, value, priority);</span>
    }

    public boolean getDisableVPN() {
<span class="nc" id="L301">        return getBooleanValue(DISABLE_VPN);</span>
    }

    public Object setDisableVPN(boolean value, int priority) {
<span class="nc" id="L305">        return setBooleanValue(DISABLE_VPN, value, priority);</span>
    }

    public boolean getDisableSmsMms() {
<span class="nc" id="L309">        return getBooleanValue(DISABLE_SMS_MMS);</span>
    }

    public Object setDisableSmsMms(boolean value, int priority) {
<span class="nc" id="L313">        return setBooleanValue(DISABLE_SMS_MMS, value, priority);</span>
    }

    private String getStringValue(String policyName) {
<span class="nc" id="L317">        List&lt;Policies&gt; arrPolicies = dataBase.PoliciesDao().getPolicyByName(policyName);</span>
<span class="nc bnc" id="L318" title="All 2 branches missed.">        if(!arrPolicies.isEmpty()) {</span>
<span class="nc" id="L319">            return arrPolicies.get(0).value;</span>
        } else {
<span class="nc" id="L321">            return &quot;&quot;;</span>
        }
    }

    private Object setStringValue(String policyName, String value, int priority) {
<span class="nc bnc" id="L326" title="All 2 branches missed.">        if(dataBase.PoliciesDao().getPolicyBy(policyName, priority).isEmpty()) {</span>
<span class="nc" id="L327">            Policies policies = new Policies();</span>
<span class="nc" id="L328">            policies.policyName = policyName;</span>
<span class="nc" id="L329">            policies.value = value;</span>
<span class="nc" id="L330">            policies.priority = priority;</span>
<span class="nc" id="L331">            dataBase.PoliciesDao().insert(policies);</span>
<span class="nc" id="L332">        } else {</span>
<span class="nc" id="L333">            Policies policies = dataBase.PoliciesDao().getPolicyBy(policyName, priority).get(0);</span>
<span class="nc" id="L334">            policies.value = value;</span>
<span class="nc" id="L335">            dataBase.PoliciesDao().update(policies);</span>
        }

        // Return the priority value
<span class="nc" id="L339">        Policies policies = dataBase.PoliciesDao().getPolicyByName(policyName).get(0);</span>
<span class="nc" id="L340">        return policies.value;</span>
    }

    private boolean getBooleanValue(String policyName) {
<span class="nc" id="L344">        String value = getStringValue(policyName);</span>
<span class="nc bnc" id="L345" title="All 2 branches missed.">        if(value.equals(&quot;&quot;)) {</span>
<span class="nc" id="L346">            value = &quot;false&quot;;</span>
        }
<span class="nc" id="L348">        return Boolean.valueOf(value);</span>
    }

    private Object setBooleanValue(String policyName, Boolean enable, int priority) {
<span class="nc" id="L352">        Object data = setStringValue(policyName, String.valueOf(enable), priority);</span>
<span class="nc bnc" id="L353" title="All 2 branches missed.">        if(data.equals(&quot;&quot;)) {</span>
<span class="nc" id="L354">            return null;</span>
        }
<span class="nc" id="L356">        return data;</span>
    }

    private int getIntValue(String policyName) {
<span class="nc" id="L360">        String value = getStringValue(policyName);</span>
<span class="nc bnc" id="L361" title="All 2 branches missed.">        if(value.equals(&quot;&quot;)) {</span>
<span class="nc" id="L362">            value = &quot;0&quot;;</span>
        }
<span class="nc" id="L364">        return Integer.parseInt(value);</span>
    }

    private Object setIntValue(String policyName, int value, int priority) {
<span class="nc" id="L368">        Object data = setStringValue(policyName, String.valueOf(value), priority);</span>
<span class="nc bnc" id="L369" title="All 2 branches missed.">        if(data.equals(&quot;&quot;)) {</span>
<span class="nc" id="L370">            return null;</span>
        }
<span class="nc" id="L372">        return data;</span>
    }

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.4.201502262128</span>Generated by the Android Gradle plugin 3.0.1</div></body></html>